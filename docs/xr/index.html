<!DOCTYPE html>
<html lang='ko'>

<head>
    <meta charset='utf-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1' />
    <title>Daily XR Archive</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&family=Pretendard:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../static/css/style.css">
    
</head>

<body>
    <header>
        <div class="gnb">
            <a href="../index.html" class="logo-link">
                <img src="../static/images/logo.jpg" alt="VAAX" class="header-logo">
            </a>
            <nav class="nav-links">
                <a href="../index.html"
                    class="">Home</a>
                <a href="../ai/index.html"
                    class="">AI읽을거리</a>
                <a href="../xr/index.html"
                    class="active">XR읽을거리</a>
                <a href="../gov/index.html"
                    class="">정부과제</a>
                <a href="../members/index.html"
                    class="">회원사소식</a>
            </nav>
        </div>
    </header>

    <div class="container">
        
<div class="page-header">
    <div>
        <p class="eyebrow">Archive</p>
        <h1>XR 뉴스 아카이브</h1>
        <p class="subtitle">AI/XR 읽을거리의 생성 이력을 날짜별로 살펴보고, 원하는 날의 뉴스를 바로 확인하세요.</p>
    </div>
</div>


<section class="today-section card">
    <div class="section-heading">
        <div>
            <p class="eyebrow">오늘 뉴스</p>
            <h2 id="selected-date-label"></h2>
            <p class="subtitle" id="selected-time-label"></p>
        </div>
        <div class="pill" id="selected-count"></div>
    </div>
    <div id="today-news-grid" class="news-grid today-grid">
        <p class="empty-msg">뉴스를 불러오는 중입니다...</p>
    </div>
</section>

<section class="calendar-section card">
    <div class="section-heading">
        <div>
            <p class="eyebrow">날짜별 아카이브</p>
            <h3>캘린더에서 날짜를 선택하세요</h3>
            <p class="subtitle">날짜 또는 번호를 누르면 상단의 뉴스 리스트가 해당 회차로 변경됩니다.</p>
        </div>
    </div>
    <div id="calendar-container" class="calendar-container"></div>
</section>

<script>
    const runEntries = [{"date_str": "2025-12-10", "day_of_week": "\uc218", "filename": "2025-12-10_124834.html", "time_str": "12:48:34"}, {"date_str": "2025-12-10", "day_of_week": "\uc218", "filename": "2025-12-10_113619.html", "time_str": "11:36:19"}, {"date_str": "2025-12-10", "day_of_week": "\uc218", "filename": "2025-12-10_110944.html", "time_str": "11:09:44"}, {"date_str": "2025-12-10", "day_of_week": "\uc218", "filename": "2025-12-10_074555.html", "time_str": "07:45:55"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_165531.html", "time_str": "16:55:31"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_155422.html", "time_str": "15:54:22"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_152250.html", "time_str": "15:22:50"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_150649.html", "time_str": "15:06:49"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_131254.html", "time_str": "13:12:54"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_112456.html", "time_str": "11:24:56"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_102606.html", "time_str": "10:26:06"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_101432.html", "time_str": "10:14:32"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_100555.html", "time_str": "10:05:55"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_095853.html", "time_str": "09:58:53"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_093243.html", "time_str": "09:32:43"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_074714.html", "time_str": "07:47:14"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_003700.html", "time_str": "00:37:00"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_003216.html", "time_str": "00:32:16"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_002222.html", "time_str": "00:22:22"}, {"date_str": "2025-12-09", "day_of_week": "\ud654", "filename": "2025-12-09_001627.html", "time_str": "00:16:27"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_235857.html", "time_str": "23:58:57"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_234917.html", "time_str": "23:49:17"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_234130.html", "time_str": "23:41:30"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_233322.html", "time_str": "23:33:22"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_233005.html", "time_str": "23:30:05"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_232844.html", "time_str": "23:28:44"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_230413.html", "time_str": "23:04:13"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_224251.html", "time_str": "22:42:51"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_223949.html", "time_str": "22:39:49"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_223154.html", "time_str": "22:31:54"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_222059.html", "time_str": "22:20:59"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_220553.html", "time_str": "22:05:53"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_202356.html", "time_str": "20:23:56"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_201700.html", "time_str": "20:17:00"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_200144.html", "time_str": "20:01:44"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_193427.html", "time_str": "19:34:27"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_192833.html", "time_str": "19:28:33"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_170828.html", "time_str": "17:08:28"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_164629.html", "time_str": "16:46:29"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_161510.html", "time_str": "16:15:10"}, {"date_str": "2025-12-08", "day_of_week": "\uc6d4", "filename": "2025-12-08_105629.html", "time_str": "10:56:29"}, {"date_str": "2025-12-06", "day_of_week": "\ud1a0", "filename": "2025-12-06_074528.html", "time_str": "07:45:28"}, {"date_str": "2025-12-05", "day_of_week": "\uae08", "filename": "2025-12-05_152717.html", "time_str": "15:27:17"}, {"date_str": "2025-12-05", "day_of_week": "\uae08", "filename": "2025-12-05_123520.html", "time_str": "12:35:20"}, {"date_str": "2025-12-05", "day_of_week": "\uae08", "filename": "2025-12-05_120037.html", "time_str": "12:00:37"}, {"date_str": "2025-12-05", "day_of_week": "\uae08", "filename": "2025-12-05_112335.html", "time_str": "11:23:35"}, {"date_str": "2025-12-05", "day_of_week": "\uae08", "filename": "2025-12-05_100814.html", "time_str": "10:08:14"}, {"date_str": "2025-12-05", "day_of_week": "\uae08", "filename": "2025-12-05_074629.html", "time_str": "07:46:29"}, {"date_str": "2025-12-04", "day_of_week": "\ubaa9", "filename": "2025-12-04_163850.html", "time_str": "16:38:50"}, {"date_str": "2025-12-04", "day_of_week": "\ubaa9", "filename": "2025-12-04_160340.html", "time_str": "16:03:40"}, {"date_str": "2025-12-04", "day_of_week": "\ubaa9", "filename": "2025-12-04_154258.html", "time_str": "15:42:58"}, {"date_str": "2025-12-04", "day_of_week": "\ubaa9", "filename": "2025-12-04_145006.html", "time_str": "14:50:06"}, {"date_str": "2025-12-04", "day_of_week": "\ubaa9", "filename": "2025-12-04_142819.html", "time_str": "14:28:19"}, {"date_str": "2025-12-04", "day_of_week": "\ubaa9", "filename": "2025-12-04_140656.html", "time_str": "14:06:56"}, {"date_str": "2025-12-04", "day_of_week": "\ubaa9", "filename": "2025-12-04_140139.html", "time_str": "14:01:39"}];
    const runsByDate = {};
    const todayGrid = document.getElementById('today-news-grid');
    const dateLabel = document.getElementById('selected-date-label');
    const timeLabel = document.getElementById('selected-time-label');
    const countLabel = document.getElementById('selected-count');
    const calendarContainer = document.getElementById('calendar-container');

    function buildRunMap() {
        runEntries.forEach((run, idx) => {
            const list = runsByDate[run.date_str] || [];
            list.push({ ...run, display_index: list.length + 1, absolute_index: idx });
            runsByDate[run.date_str] = list;
        });

        Object.values(runsByDate).forEach(list => {
            list.sort((a, b) => (a.time_str < b.time_str ? 1 : -1));
        });
    }

    function formatDateLabel(dateStr) {
        const parts = dateStr.split('-');
        if (parts.length !== 3) return dateStr;
        return `${parts[0]}년 ${Number(parts[1])}월 ${Number(parts[2])}일`;
    }

    function renderTodayNews(articles, run) {
        todayGrid.innerHTML = '';

        if (!articles.length) {
            todayGrid.innerHTML = '<p class="empty-msg">이 날짜에는 뉴스가 없습니다.</p>';
            return;
        }

        dateLabel.textContent = `${formatDateLabel(run.date_str)} (${run.day_of_week})`;
        timeLabel.textContent = `${run.time_str} 생성됨`;
        countLabel.textContent = `${run.display_index}회차 · ${articles.length}개 기사`;

        articles.forEach(article => {
            const card = document.createElement('article');
            card.className = 'news-card';

            const meta = document.createElement('div');
            meta.className = 'news-card-meta';
            const metaParts = [];
            if (article.source) metaParts.push(article.source);
            if (article.published) metaParts.push(article.published);
            meta.textContent = metaParts.join(' · ');

            const title = document.createElement('h3');
            title.className = 'news-card-title';
            const link = document.createElement('a');
            link.href = article.link;
            link.target = '_blank';
            link.textContent = article.title;
            title.appendChild(link);

            const summary = document.createElement('div');
            summary.className = 'news-card-summary';
            summary.innerHTML = article.summary;

            card.appendChild(title);
            card.appendChild(meta);
            if (article.image) {
                const thumb = document.createElement('div');
                thumb.className = 'news-card-thumb';
                const img = document.createElement('img');
                img.src = article.image;
                img.alt = 'thumbnail';
                img.loading = 'lazy';
                thumb.appendChild(img);
                card.appendChild(thumb);
            }
            card.appendChild(summary);

            todayGrid.appendChild(card);
        });
    }

    async function loadRun(dateStr, runIndex = 0) {
        const runList = runsByDate[dateStr];
        if (!runList || !runList[runIndex]) return;

        const run = runList[runIndex];
        todayGrid.innerHTML = '<p class="empty-msg">뉴스를 불러오는 중입니다...</p>';

        try {
            const response = await fetch(`daily/${run.filename}`);
            const html = await response.text();
            const doc = new DOMParser().parseFromString(html, 'text/html');
            const articles = Array.from(doc.querySelectorAll('.news-item')).map(item => ({
                title: item.querySelector('.news-title a')?.textContent?.trim() || '제목 없음',
                link: item.querySelector('.news-title a')?.getAttribute('href') || '#',
                summary: item.querySelector('.news-summary')?.innerHTML || '',
                source: item.querySelector('.news-meta .source-link')?.textContent?.trim() || '',
                published: item.querySelector('.news-meta')?.textContent?.split('|')[1]?.trim() || '',
                image: item.querySelector('.news-image img')?.getAttribute('src') || ''
            }));

            renderTodayNews(articles, run);
            highlightActive(dateStr, run.display_index);
        } catch (err) {
            todayGrid.innerHTML = `<p class="empty-msg">뉴스를 불러오지 못했습니다: ${err}</p>`;
        }
    }

    function buildCalendar() {
        const monthGroups = {};
        Object.keys(runsByDate).forEach(dateStr => {
            const dateObj = new Date(dateStr + 'T00:00:00');
            if (isNaN(dateObj)) return;
            const key = `${dateObj.getFullYear()}-${dateObj.getMonth()}`;
            if (!monthGroups[key]) monthGroups[key] = { year: dateObj.getFullYear(), month: dateObj.getMonth(), dates: [] };
            monthGroups[key].dates.push(dateObj);
        });

        const sortedKeys = Object.keys(monthGroups).sort((a, b) => Number(b.split('-')[0]) - Number(a.split('-')[0]) || Number(b.split('-')[1]) - Number(a.split('-')[1]));
        calendarContainer.innerHTML = '';

        sortedKeys.forEach(key => {
            const group = monthGroups[key];
            const firstDay = new Date(group.year, group.month, 1);
            const lastDay = new Date(group.year, group.month + 1, 0);

            const monthBlock = document.createElement('div');
            monthBlock.className = 'month-block';

            const header = document.createElement('div');
            header.className = 'month-header';
            header.textContent = `${group.year}년 ${group.month + 1}월`;
            monthBlock.appendChild(header);

            const weekdayRow = document.createElement('div');
            weekdayRow.className = 'weekday-row';
            ['일', '월', '화', '수', '목', '금', '토'].forEach(d => {
                const wd = document.createElement('div');
                wd.textContent = d;
                weekdayRow.appendChild(wd);
            });
            monthBlock.appendChild(weekdayRow);

            const grid = document.createElement('div');
            grid.className = 'calendar-grid';

            for (let i = 0; i < firstDay.getDay(); i++) {
                grid.appendChild(document.createElement('div'));
            }

            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dateStr = `${group.year}-${String(group.month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const cell = document.createElement('div');
                cell.className = 'calendar-cell';
                cell.dataset.date = dateStr;

                const dateLabel = document.createElement('button');
                dateLabel.type = 'button';
                dateLabel.className = 'cell-date';
                dateLabel.textContent = day;
                dateLabel.addEventListener('click', () => loadRun(dateStr, 0));
                cell.appendChild(dateLabel);

                const runs = runsByDate[dateStr];
                if (runs && runs.length) {
                    const badges = document.createElement('div');
                    badges.className = 'run-badges';
                    runs.forEach((run, idx) => {
                        const badge = document.createElement('button');
                        badge.type = 'button';
                        badge.className = 'run-badge';
                        badge.textContent = run.display_index;
                        badge.title = `${run.time_str} 회차 보기`;
                        badge.dataset.date = dateStr;
                        badge.dataset.idx = run.display_index;
                        badge.addEventListener('click', (e) => {
                            e.stopPropagation();
                            loadRun(dateStr, idx);
                        });
                        badges.appendChild(badge);
                    });
                    cell.appendChild(badges);
                    cell.addEventListener('click', () => loadRun(dateStr, 0));
                } else {
                    cell.classList.add('empty');
                }

                grid.appendChild(cell);
            }

            monthBlock.appendChild(grid);
            calendarContainer.appendChild(monthBlock);
        });
    }

    function highlightActive(dateStr, displayIndex) {
        document.querySelectorAll('.calendar-cell').forEach(cell => cell.classList.remove('active'));
        const selector = `.calendar-cell[data-date="${dateStr}"]`;
        const target = document.querySelector(selector);
        if (target) target.classList.add('active');

        document.querySelectorAll('.run-badge').forEach(b => b.classList.remove('active'));
        if (displayIndex) {
            const badge = document.querySelector(`.run-badge[data-date="${dateStr}"][data-idx="${displayIndex}"]`);
            if (badge) badge.classList.add('active');
        }
    }

    buildRunMap();
    buildCalendar();
    const newest = runEntries[0];
    if (newest) {
        loadRun(newest.date_str, 0);
    }
</script>


    </div>

    <footer>
        <p>&copy; 2025 AI News Daily Project. All rights reserved.</p>
    </footer>
</body>

</html>